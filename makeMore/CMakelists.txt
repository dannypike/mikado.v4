# Copyright (c) 2024 Gamaliel Ltd
#
# MakeMore is an MLP test application for libtorch
#
# 3.16 is required for target_precompile_headers(...PRECOMPILE_HEADERS_REUSE_FROM...)
# 3.25 is required for CMAKE_C_COMPILE_OPTIONS_MSVC_DEBUG_INFORMATION_FORMAT
cmake_minimum_required (VERSION 3.25)

set(DUMP_VARIABLES FALSE)
set(PROJECT_NAME MakeMore)
set(TARGET makeMore)

set(CMAKE_FOLDER ${CMAKE_CURRENT_SOURCE_DIR}/../cmake)
include(${CMAKE_FOLDER}/header.cmake)

set(SRC_FILES
   "src/makeMore.cpp"
)

# Define the target as an EXE
include(${CMAKE_FOLDER}/common-exe.cmake)
if(TORCH_USE_FIND_PACKAGE)
   message("Using find_package to locate the Torch files")
   set(Torch_DIR "E:/Projects/AI/Pytorch/cpp-2.21/cuda-dbg-11.8/libtorch/share/cmake/Torch")
   find_package(Torch REQUIRED)
   set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${TORCH_CXX_FLAGS}")
   target_include_directories(${TARGET} PRIVATE "${TORCH_INCLUDE_DIRS}")
   target_link_libraries(${TARGET} PRIVATE "${TORCH_LIBRARIES}")
else()
   message("Linking to Torch files explicitly")
   include(${CMAKE_FOLDER}/torch-libraries.cmake)
endif()

include(${CMAKE_FOLDER}/common-all.cmake)
include(${CMAKE_FOLDER}/footer.cmake)
